-- Initialize GUI Library
local ScreenGui = Instance.new("ScreenGui")
local Frame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local AimbotToggle = Instance.new("TextButton")
local ESPToggle = Instance.new("TextButton")
local SmoothnessSlider = Instance.new("TextBox") -- Using TextBox as slider input
local KeyDropdown = Instance.new("TextButton")

-- GUI properties
ScreenGui.Parent = game.CoreGui
Frame.Parent = ScreenGui
Frame.Size = UDim2.new(0, 300, 0, 400)
Frame.Position = UDim2.new(0.5, -150, 0.5, -200)
Frame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Frame.Visible = false  -- Start as hidden

Title.Parent = Frame
Title.Size = UDim2.new(0, 300, 0, 50)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.Text = "Game GUI"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.BackgroundTransparency = 1

-- Aimbot Toggle
AimbotToggle.Parent = Frame
AimbotToggle.Size = UDim2.new(0, 200, 0, 50)
AimbotToggle.Position = UDim2.new(0, 50, 0, 60)
AimbotToggle.Text = "Toggle Aimbot"
AimbotToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
AimbotToggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)

-- ESP Toggle
ESPToggle.Parent = Frame
ESPToggle.Size = UDim2.new(0, 200, 0, 50)
ESPToggle.Position = UDim2.new(0, 50, 0, 120)
ESPToggle.Text = "Toggle ESP"
ESPToggle.TextColor3 = Color3.fromRGB(255, 255, 255)
ESPToggle.BackgroundColor3 = Color3.fromRGB(50, 50, 50)

-- Smoothness Slider
SmoothnessSlider.Parent = Frame
SmoothnessSlider.Size = UDim2.new(0, 200, 0, 50)
SmoothnessSlider.Position = UDim2.new(0, 50, 0, 180)
SmoothnessSlider.Text = "0.5"  -- Default strength
SmoothnessSlider.TextColor3 = Color3.fromRGB(255, 255, 255)
SmoothnessSlider.BackgroundColor3 = Color3.fromRGB(70, 70, 70)

-- Key Dropdown (for selecting custom key)
KeyDropdown.Parent = Frame
KeyDropdown.Size = UDim2.new(0, 200, 0, 50)
KeyDropdown.Position = UDim2.new(0, 50, 0, 240)
KeyDropdown.Text = "Select Key: Left Ctrl"
KeyDropdown.TextColor3 = Color3.fromRGB(255, 255, 255)
KeyDropdown.BackgroundColor3 = Color3.fromRGB(50, 50, 50)

-- Variables
local aimbotEnabled = false
local espEnabled = false
local aimbotSmoothness = tonumber(SmoothnessSlider.Text)
local selectedKey = Enum.KeyCode.LeftControl -- Default key
local guiVisible = false

-- Functions
local function toggleAimbot()
    aimbotEnabled = not aimbotEnabled
    AimbotToggle.Text = aimbotEnabled and "Aimbot: ON" or "Aimbot: OFF"
end

local function toggleESP()
    espEnabled = not espEnabled
    ESPToggle.Text = espEnabled and "ESP: ON" or "ESP: OFF"
    if espEnabled then
        -- Insert code for team check here
        -- Example: Iterate over players and highlight only enemies
    end
end

local function adjustSmoothness()
    aimbotSmoothness = tonumber(SmoothnessSlider.Text) or 0.5
    SmoothnessSlider.Text = tostring(aimbotSmoothness)
end

local function changeKey()
    if selectedKey == Enum.KeyCode.LeftControl then
        selectedKey = Enum.KeyCode.ButtonR2 -- Example for right-click
        KeyDropdown.Text = "Select Key: Right Click"
    elseif selectedKey == Enum.KeyCode.ButtonR2 then
        selectedKey = Enum.KeyCode.ButtonL2 -- Example for left click
        KeyDropdown.Text = "Select Key: Left Click"
    else
        selectedKey = Enum.KeyCode.LeftControl
        KeyDropdown.Text = "Select Key: Left Ctrl"
    end
end

local function toggleGuiVisibility()
    guiVisible = not guiVisible
    Frame.Visible = guiVisible
end

local function aimAt(target)
    if not target then return end
    local playerCamera = workspace.CurrentCamera
    local headPosition = target:FindFirstChild("Head").Position
    local smoothFactor = aimbotSmoothness

    playerCamera.CFrame = CFrame.new(playerCamera.CFrame.Position, headPosition:Lerp(playerCamera.CFrame.Position, smoothFactor))
end

-- Connect GUI events
AimbotToggle.MouseButton1Click:Connect(toggleAimbot)
ESPToggle.MouseButton1Click:Connect(toggleESP)
SmoothnessSlider.FocusLost:Connect(adjustSmoothness)
KeyDropdown.MouseButton1Click:Connect(changeKey)

-- Aimbot and ESP Key Handling
game:GetService("UserInputService").InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.RightShift then
        toggleGuiVisibility()
    elseif input.KeyCode == selectedKey and aimbotEnabled then
        -- Target the nearest enemy player here (pseudo-code below)
        local targetPlayer = nil
        -- Iterate over players and choose the closest target to aim at
        for _, player in pairs(game.Players:GetPlayers()) do
            if player.Team ~= game.Players.LocalPlayer.Team then -- Team check
                targetPlayer = player.Character -- Assuming enemy character has a "Head"
                break
            end
        end
        aimAt(targetPlayer)
    end
end)

print("GUI with Aimbot, ESP, Smoothness Slider, Team Check, and Right Shift toggle loaded.")
