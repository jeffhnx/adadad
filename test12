-- Create a GUI
local player = game.Players.LocalPlayer
local mouse = player:GetMouse()
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = player.PlayerGui

-- Create a frame for the GUI
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 200, 0, 100)
frame.Position = UDim2.new(0.5, -100, 0.5, -50)
frame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
frame.Parent = screenGui

-- Create a toggle button for the aimbot
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(0, 180, 0, 50)
toggleButton.Position = UDim2.new(0, 10, 0, 25)
toggleButton.BackgroundColor3 = Color3.fromRGB(0, 128, 0)
toggleButton.Text = "Toggle Aimbot"
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.Font = Enum.Font.SourceSans
toggleButton.TextSize = 24
toggleButton.Parent = frame

-- Aimbot state (off by default)
local aimbotEnabled = false

-- Function to handle the aimbot toggle
local function toggleAimbot()
    aimbotEnabled = not aimbotEnabled
    if aimbotEnabled then
        toggleButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)  -- Red for enabled
        toggleButton.Text = "Aimbot Enabled"
        print("Aimbot Enabled")
    else
        toggleButton.BackgroundColor3 = Color3.fromRGB(0, 128, 0)  -- Green for disabled
        toggleButton.Text = "Aimbot Disabled"
        print("Aimbot Disabled")
    end
end

-- Connect the toggle function to the button click event
toggleButton.MouseButton1Click:Connect(toggleAimbot)

-- Hide the entire GUI initially
screenGui.Enabled = false

-- Detect Right Shift key press to toggle visibility of the entire GUI
local UserInputService = game:GetService("UserInputService")

UserInputService.InputBegan:Connect(function(input, gameProcessedEvent)
    if gameProcessedEvent then return end  -- Ignore input if the game has already processed it

    if input.UserInputType == Enum.UserInputType.Keyboard and input.KeyCode == Enum.KeyCode.RightShift then
        -- Toggle the visibility of the entire GUI
        screenGui.Enabled = not screenGui.Enabled
    end
end)

-- Function to find the closest player to the center of the screen
local function getClosestPlayer()
    local closestPlayer = nil
    local shortestDistance = math.huge  -- Start with a very large distance

    -- Loop through all players
    for _, target in pairs(game.Players:GetPlayers()) do
        if target ~= player and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            local targetPosition = target.Character.HumanoidRootPart.Position
            local screenPosition = game:GetService("Workspace").CurrentCamera:WorldToScreenPoint(targetPosition)

            -- Calculate the distance from the center of the screen (mouse position)
            local screenCenter = Vector2.new(mouse.X, mouse.Y)
            local distance = (screenPosition - screenCenter).Magnitude

            -- Find the closest player
            if distance < shortestDistance then
                shortestDistance = distance
                closestPlayer = target
            end
        end
    end

    return closestPlayer
end

-- Function to aim at the closest player
local function aimAtClosestPlayer()
    if aimbotEnabled then
        local closestPlayer = getClosestPlayer()

        if closestPlayer and closestPlayer.Character and closestPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local targetPosition = closestPlayer.Character.HumanoidRootPart.Position
            local camera = game:GetService("Workspace").CurrentCamera
            local screenPosition = camera:WorldToScreenPoint(targetPosition)

            -- Aim at the target's position (move the mouse to the target's screen position)
            -- You can adjust the mouse position or use an aimbot method here
            mouse.Move = Vector2.new(screenPosition.X, screenPosition.Y)
        end
    end
end

-- Continuously aim at the closest player when aimbot is enabled
game:GetService("RunService").Heartbeat:Connect(function()
    aimAtClosestPlayer()
end)
